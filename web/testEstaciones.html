<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Estaciones de Calidad del Aire</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/letra.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<header>
    <?php include("../template/cabecera.php"); ?>
</header>

<script>
function buscarEstaciones(lat, lng, radioKm) {
    // Calcular grados de latitud y longitud para el radio
    var latitudGrados = radioKm / 111; // Aproximación
    var longitudGrados = radioKm / (111 * Math.cos(lat * Math.PI / 180)); // Ajuste por coseno de la latitud
    console.log("longitudGrados:"+longitudGrados+" latitudGrados:"+latitudGrados)
    // Calcular los límites
    var latMin = lat - latitudGrados;
    var latMax = lat + latitudGrados;
    var lngMin = lng - longitudGrados;
    var lngMax = lng + longitudGrados;
    
    // Construir la URL de la API
    var token = "a6e94931d9ab07c950fbdce95db0c38d4ccb13b8"; // Tu token API
    var latlngBounds = latMin + "," + lngMin + "," + latMax + "," + lngMax;
    console.log(latlngBounds);
    var url = "https://api.waqi.info/map/bounds/?token=" + token + "&latlng=" + latlngBounds;
    
    // Hacer la solicitud a la API
    $.getJSON(url, function(response) {
        if (response.status === "ok") {
            console.log("Estaciones encontradas: ", response.data);
        } else {
            console.log("No se pudo obtener la información de la API");
        }
    });
}

$(document).ready(function() {
    // Ejemplo de uso: Buscar estaciones en un radio de 80km alrededor de Gandía
    buscarEstaciones(38.994537, -0.168094, 99);
});
</script>
</body>
</html>
